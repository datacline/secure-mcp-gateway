# MCP Gateway Policy Configuration
# Defines access control rules for MCP servers and tools

# Role definitions
roles:
  admin:
    description: "Full access to all MCP servers and tools"
    permissions:
      - resource: "*"
        actions: ["*"]

  developer:
    description: "Can list and invoke tools on development servers"
    permissions:
      - resource: "mcp:dev-server:*"
        actions: ["list_tools", "invoke_tool"]
      - resource: "mcp:staging-server:*"
        actions: ["list_tools"]

  analyst:
    description: "Read-only access to specific tools"
    permissions:
      - resource: "mcp:*:sqlite_reader"
        actions: ["invoke_tool"]
      - resource: "mcp:*:file_loader"
        actions: ["invoke_tool"]

  user:
    description: "Basic user with limited access"
    permissions:
      - resource: "mcp:*:*"
        actions: ["list_tools"]

# User-to-role mappings
user_roles:
  admin@example.com:
    - admin

  dev@example.com:
    - developer

  analyst@example.com:
    - analyst

  anonymous:
    - user

# Group-to-role mappings (for group-based auth)
group_roles:
  /admins:
    - admin
  /developers:
    - developer
  /analysts:
    - analyst

# Policy rules (additional fine-grained rules)
rules:
  - name: "Block dangerous tools in production"
    condition:
      mcp_server: "prod-server"
      tool_name_pattern: ".*delete.*|.*drop.*"
    action: deny
    priority: 100

  - name: "Rate limit for anonymous users"
    condition:
      user: "anonymous"
    action: allow
    metadata:
      rate_limit: "10/minute"

  - name: "Require approval for write operations"
    condition:
      action: "invoke_tool"
      tool_permissions: ["write"]
    action: allow
    metadata:
      require_approval: true

# Default policy
default_policy: deny
